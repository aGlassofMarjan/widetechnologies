<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place Order System</title>
    <link rel="stylesheet" href="/css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>

<div class="container text-center">
    <h1 class="text-3xl font-bold underline">
        Product List
      </h1>

      <!-- <form id="productForm">
        <label for="name">Name</label>
        <input type="text" id="name" name="name" required>

        <label for="type">Type</label>
        <input type="text" id="type" name="type" required>

        <label for="price">Price</label>
        <input type="number" id="price" name="price" required>

        <label for="quantity">Quantity</label>
        <input type="number" id="quantity" name="quantity" required>

        <button type="button" onclick="addToCart()">Add to Cart</button>
    </form> -->

    <section class="max-w-4xl p-6 mx-auto bg-white rounded-md shadow-md mb-5">
        <h2 class="text-lg font-semibold text-gray-700 capitalize">Add Product</h2>
    
        <form id="productForm">
            <div class="grid grid-cols-1 gap-6 mt-4 sm:grid-cols-2">
                <div>
                    <label class="text-gray-700" for="username">Name</label>
                    <input id="username" type="text" name="name" class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-200 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                </div>
    
                <div>
                    <label class="text-gray-700" for="emailAddress">Type</label>
                    <input id="emailAddress" type="text" name="type" class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-200 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                </div>
    
                <div>
                    <label class="text-gray-700" for="password">Price</label>
                    <input id="password" type="number" name="price" class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-200 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                </div>

                <div>
                    <label class="text-gray-700" for="password">Quantity</label>
                    <input id="password" type="number" name="quantity" class="block w-full px-4 py-2 mt-2 text-gray-700 bg-white border border-gray-200 rounded-md focus:border-blue-400 focus:ring-blue-300 focus:ring-opacity-40 focus:outline-none focus:ring">
                </div>

            </div>
    
            <div class="flex justify-end mt-6">
                <button onclick="addToCart()" class="px-8 py-2.5 leading-5 text-white transition-colors duration-300 transform bg-gray-700 rounded-md hover:bg-gray-600 focus:outline-none focus:bg-gray-600">Save</button>
            </div>
        </form>
    </section>

    <div class="w-full flex justify-center">
        <div class="grid grid-cols-4 gap-8" id="productList">
            <!-- Products will be dynamically inserted here -->
        </div>
    </div>

    
    <div class="mt-6">
        <button class="px-8 py-2.5 leading-5 text-white transition-colors duration-300 transform bg-gray-700 rounded-md hover:bg-gray-600 focus:outline-none focus:bg-gray-600" onclick="previousPage()">Previous</button>
        <span id="pageIndicator"></span>
        <button class="px-8 py-2.5 leading-5 text-white transition-colors duration-300 transform bg-gray-700 rounded-md hover:bg-gray-600 focus:outline-none focus:bg-gray-600" onclick="nextPage()">Next</button>
    </div>
    <br>
    <hr>
    <br>
    <h1 class="font-bold text-3xl">Order Cart</h1>
    <br>

    <table class="divide-y divide-gray-200">
        <thead class="bg-gray-50">
            <tr>
                <th scope="col" class="px-12 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500">
                    Name
                </th>
                <th scope="col" class="px-12 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500">
                    File size
                </th>

                <th scope="col" class="px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500">
                    Date uploaded
                </th>

                <th scope="col" class="px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500">
                    Last updated
                </th>

                <th scope="col" class="px-4 py-3.5 text-sm font-normal text-left rtl:text-right text-gray-500">
                    Uploaded by
                </th>

                <th scope="col" class="relative py-3.5 px-4">
                    <span class="sr-only">Edit</span>
                </th>
            </tr>
        </thead>
        <tbody class="bg-white divide-gray-200">
            <tr>
                <td class="px-12 py-4 text-sm font-normal text-gray-700 whitespace-nowrap">
                    asd
                </td>
                <td class="px-12 py-4 text-sm font-normal text-gray-700 whitespace-nowrap">
                    200 KB
                </td>
                <td class="px-4 py-4 text-sm text-gray-500 whitespace-nowrap">Jan 4, 2022</td>
                <td class="px-4 py-4 text-sm text-gray-500 whitespace-nowrap">Jan 4, 2022</td>
                <td class="px-4 py-4 text-sm text-gray-500 whitespace-nowrap">Lana Steiner</td>
                <td class="px-4 py-4 text-sm whitespace-nowrap">
                    <button class="px-1 py-1 text-gray-500 transition-colors duration-200 rounded-lg hover:bg-gray-100">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z" />
                        </svg>
                    </button>
                </td>
            </tr>

        </tbody>
    </table>
</div>

<script>
    let currentPage = 0;
    const pageSize = 10;

    function fetchProducts(page, size) {
        fetch(`/products?page=${page}&size=${size}`)
            .then(response => response.json())
            .then(data => {
                displayProducts(data);
                updatePageIndicator(page);
            })
            .catch(error => console.error('Error fetching products:', error));
    }

    function displayProducts(products) {
        const productList = document.getElementById('productList');
        productList.innerHTML = products.map(product => `
            <div class="flex overflow-hidden bg-white rounded-lg shadow-lg">
                <div class="w-full p-4">
                    <h1 class="text-xl font-bold text-gray-800">${product.name}</h1>
                    <p class="mt-2 text-sm text-gray-600 ">Type: ${product.type}</p>
                    <p class="mt-2 text-sm text-gray-600 ">Quantity: ${product.quantity}</p>
            
                    <div class="flex justify-between mt-3">
                        <h1 class="text-lg font-bold text-gray-700 md:text-xl">$${product.price}</h1>
                        <button class="px-2 py-1 text-xs font-bold text-white uppercase transition-colors duration-300 transform bg-gray-800 rounded hover:bg-gray-700 focus:outline-none focus:bg-gray-700 ">Add to Cart</button>
                    </div>
                </div>
            </div>
        `).join('');
    }

    function addToCart() {
            const product = {
                name: document.getElementById('name').value,
                type: document.getElementById('type').value,
                price: parseFloat(document.getElementById('price').value),
                quantity: parseInt(document.getElementById('quantity').value)
            };

            fetch('/products', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(product)
            })
            .then(response => response.json())
            .then(data => {
                cart.push({ ...data, total: data.price * data.quantity });
                updateCartTable();
            })
            .catch(error => console.error('Error:', error));
        }


    function updatePageIndicator(page) {
        document.getElementById('pageIndicator').innerText = `Page ${page + 1}`;
    }

    function nextPage() {
        currentPage++;
        fetchProducts(currentPage, pageSize);
    }

    function previousPage() {
        if (currentPage > 0) {
            currentPage--;
            fetchProducts(currentPage, pageSize);
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        fetchProducts(currentPage, pageSize);
    });
</script>

</body>
</html>
